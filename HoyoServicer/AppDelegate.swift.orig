//
//  AppDelegate.swift
//  HoyoServicer
//
//  Created by èµµå…µ on 16/3/28.
//  Copyright Â© 2016å¹´ com.ozner.net. All rights reserved.
//

import UIKit
import CoreData
import Reachability
import SwiftyJSON

// å½“å‰æ”¯ä»˜çŠ¶æ€çš„æšä¸¾
enum CURRENT_PAY_TYPE : Int{
   case NONE = 0 // æœªæ”¯ä»˜
   case ALIPAY = 1 // æ”¯ä»˜å®æ”¯ä»˜
   case WEIXIN = 2 // å¾®ä¿¡æ”¯ä»˜
}

var Current_pay_type :CURRENT_PAY_TYPE = .NONE // é»˜è®¤æœªé€‰æ‹©æ”¯ä»˜æ–¹å¼
var isSuccessWithPayType = false // é€‰æ‹©äº†æ”¯ä»˜æ–¹å¼åæ˜¯å¦æ”¯ä»˜æˆåŠŸ


enum PushType {
    /// æ™®é€š
    case String
    /// ç§¯åˆ†
    case Score
    /// æŒ‡æ´¾è®¢å•
    case Ordernotify
    /// å¯æŠ¢è®¢å•
    case Orderrob
}

var appDelegate: AppDelegate {
    return UIApplication.sharedApplication().delegate as! AppDelegate
}
@UIApplicationMain
class AppDelegate: UIResponder, UIApplicationDelegate, WXApiDelegate{
    
    var window: UIWindow? = { 
        let v = UIWindow(frame: UIScreen.mainScreen().bounds)
        return v
    }()
    
    
    
    lazy var loginViewController: LoginAndRegisterViewController = {
        
        return    LoginAndRegisterViewController.init(nibName: "LoginAndRegisterViewController", bundle: nil)
    }()
    /// ç½‘ç»œçŠ¶æ€
    var reachOfNetwork:Reachability?
    //ä¸»è§†å›¾æ§åˆ¶å™¨
    var mainViewController: MainViewController!
    
    var pushType: PushType?
    
    func application(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -> Bool {
        Bugly.startWithAppId("900029559")
        
        //æ£€æŸ¥ç½‘ç»œçŠ¶å†µï¼Œæ— ç½‘ç»œï¼Œwifiï¼Œæ™®é€šç½‘ç»œä¸‰ç§æƒ…å†µå®æ—¶å˜åŒ–é€šçŸ¥
        reachOfNetwork = Reachability(hostName: "www.baidu.com")
        reachOfNetwork!.startNotifier()
        
        //ç½‘ç»œå˜åŒ–é€šçŸ¥ï¼Œåœ¨éœ€è¦çŸ¥é“çš„åœ°æ–¹åŠ ä¸Šæ­¤é€šçŸ¥å³å¯
        NSNotificationCenter.defaultCenter().addObserver(self, selector: #selector(reachabilityChanged), name: kReachabilityChangedNotification, object: nil)
        
        
        
        //æé†’ç”¨æˆ·ç»™appæ‰“åˆ†//
        //        Appirater.setAppId("955305764")
        //        Appirater.setDaysUntilPrompt(1)
        //        Appirater.setUsesUntilPrompt(1)
        //        Appirater.setSignificantEventsUntilPrompt(-1)
        //        Appirater.setTimeBeforeReminding(2)
        //        Appirater.setDebug(true)
        //        Appirater.appLaunched(true)
        
        //è®¾ç½®çŠ¶æ€æ å­—ä½“ä¸ºç™½è‰²
        UIApplication.sharedApplication().statusBarStyle=UIStatusBarStyle.LightContent
        
        //æ ‡è®°æ˜¯å¦ç¬¬ä¸€æ¬¡ç™»é™†
        let isFristOpen = NSUserDefaults.standardUserDefaults().objectForKey("isFristOpenApp")
        
        if isFristOpen == nil {
            let guideVC = RNGuideViewController()
            
            guideVC.skipClosure = { [weak self]() -> Void in
                
                UIView.animateWithDuration(1.2, animations: {
                    
                    let newTransform = CGAffineTransformMakeScale(1.1, 1.1)
                    guideVC.view.transform = newTransform
                    
                    }, completion: { (finished) in
                        self!.window!.rootViewController = self!.loginViewController
                        
                })
                
            }
            window?.rootViewController = guideVC
            NSUserDefaults.standardUserDefaults().setObject("isFristOpenApp", forKey: "isFristOpenApp")
        } else {
            
            User.loginWithLocalUserInfo(
                success: {
                    [weak self] user in
                    User.currentUser = user
                    
                    self?.window?.rootViewController = MainViewController()
                },
                failure: {[weak self] (error) in
                    
                    self?.window!.rootViewController = self?.loginViewController
                    
                })
        }
        //window!.rootViewController = loginViewController
        
        let delayTime = dispatch_time(DISPATCH_TIME_NOW, __int64_t(5 * NSEC_PER_SEC))
        dispatch_after(delayTime, dispatch_get_main_queue()) {
            
            weak var weakSelf = self                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
            NetworkManager.defaultManager!.POST("AppLogin",
                                                parameters: [
                                                    "phone": "15026981614",
                                                    "password": "123456"
                ],
                                                success: {
                                                    data in
                                                    weakSelf?.CheckVerion()
                },
                                                failure: nil)
        }
        
        
        
        
        window!.makeKeyAndVisible()
        
        
        //Required åˆ¤æ–­å½“å‰è®¾å¤‡ç‰ˆæœ¬
        if Float(UIDevice.currentDevice().systemVersion) >= 8.0 {
            
            let type:UInt = UIUserNotificationType.Alert.rawValue | UIUserNotificationType.Sound.rawValue | UIUserNotificationType.Badge.rawValue
            
            JPUSHService.registerForRemoteNotificationTypes(type, categories: nil)
            
        } else {
            let type:UInt = UIUserNotificationType.Alert.rawValue | UIUserNotificationType.Sound.rawValue | UIUserNotificationType.Badge.rawValue | UIUserNotificationType.Sound.rawValue
            
            JPUSHService.registerForRemoteNotificationTypes(type, categories: nil)
        }
        //æ³¨å†Œæå…‰
        JPUSHService.setupWithOption(launchOptions, appKey: "78f40fd899d1598548afa084", channel: nil, apsForProduction: true)
        
        if (launchOptions != nil) {
            let remoteNotification = launchOptions![UIApplicationLaunchOptionsRemoteNotificationKey];
            NSUserDefaults.standardUserDefaults().setValue("HomeOrderNotification", forKey: OrderPushNotification)
            
            //è¿™ä¸ªåˆ¤æ–­æ˜¯åœ¨ç¨‹åºæ²¡æœ‰è¿è¡Œçš„æƒ…å†µä¸‹æ”¶åˆ°é€šçŸ¥ï¼Œç‚¹å‡»é€šçŸ¥è·³è½¬é¡µé¢
            if (remoteNotification != nil) {
                
            }
        }
        
        //å…³é—­è¿æ¥
        NSNotificationCenter.defaultCenter().addObserver(self, selector: #selector(AppDelegate.JPushDidClose(_:)), name: kJPFNetworkDidCloseNotification, object: nil)
        
        //æ³¨å†ŒæˆåŠŸ
        NSNotificationCenter.defaultCenter().addObserver(self, selector: #selector(AppDelegate.JPushDidRegister(_:)), name: kJPFNetworkDidRegisterNotification, object: nil)
        
        //ç™»é™†æˆåŠŸ
        NSNotificationCenter.defaultCenter().addObserver(self, selector: #selector(AppDelegate.JPushDidLogin(_:)), name: kJPFNetworkDidLoginNotification, object: nil)
        
        //æ”¶åˆ°è‡ªå®šä¹‰æ¶ˆæ¯
        NSNotificationCenter.defaultCenter().addObserver(self, selector: #selector(AppDelegate.JPushDidReceiveMessage(_:)), name: kJPFNetworkDidReceiveMessageNotification, object: nil)
        
        
        // å¾®ä¿¡æ”¯ä»˜æ³¨å†Œ
        WXApi.registerApp("wx1baa87b7f1b6fad1", withDescription: "æµ©ä¼˜æ”¯ä»˜")
        
        return true
    }
    
    /**
     ç™»å‡ºå¤„ç†
     */
    func LoginOut()
    {
        
        if appDelegate.mainViewController != nil{
            
            appDelegate.mainViewController.dismissViewControllerAnimated(true, completion: nil)
            appDelegate.mainViewController = nil
        }
        
        //æ¸…ç†ç”¨æˆ·æ–‡ä»¶
        
        NetworkManager.clearCookies()
        DataManager.defaultManager = nil
        window?.rootViewController = loginViewController
        //é€€å‡ºç™»å½•åˆ é™¤æœ¬åœ°ç”¨æˆ·åå’Œå¯†ç 
        //        NSUserDefaults.standardUserDefaults().removeObjectForKey("UserName")
        //        NSUserDefaults.standardUserDefaults().removeObjectForKey("PassWord")
        
    }
    //æ¥æ”¶åˆ°ç½‘ç»œå˜åŒ–åå¤„ç†äº‹ä»¶
    func reachabilityChanged(notification:NSNotification){
        let reach = notification.object
        print(reachOfNetwork?.currentReachabilityString())
        if ((reach?.isKindOfClass(Reachability.classForCoder())) != false){
            
            let status:NetworkStatus = (reach?.currentReachabilityStatus())! //currentReachabilityStatus];
            
            switch status
            {
            case .NotReachable:
                print("ç½‘ç»œä¸å¯ç”¨")
                break
            case .ReachableViaWiFi:
                print("WIFIå·²è¿æ¥")
                break
            case .ReachableViaWWAN:
                print("æ™®é€šç½‘ç»œå·²è¿æ¥")
                break
                
            }
            
            
        }
        
    }
    
    // åº”ç”¨é—´è·³è½¬å›è°ƒ
    func application(application: UIApplication, handleOpenURL url: NSURL) -> Bool {
        
//       // isSuccessWithPayType = true
//        Current_pay_type = .NONE
        return WXApi.handleOpenURL(url, delegate: self)
    }
    
    func application(application: UIApplication, openURL url: NSURL, sourceApplication: String?, annotation: AnyObject) -> Bool {
        
//       // isSuccessWithPayType = true
//        Current_pay_type = .NONE
        return WXApi.handleOpenURL(url, delegate: self)
    }
    
    
    
    func applicationWillResignActive(application: UIApplication) {
        // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
        // Use this method to pause ongoing tasks, disable timers, and throttle down OpenGL ES frame rates. Games should use this method to pause the game.
    }
    
    func applicationDidEnterBackground(application: UIApplication) {
        // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.
        // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
        UIScreen.mainScreen()
    }
    
    func applicationWillEnterForeground(application: UIApplication) {
        application.applicationIconBadgeNumber = 0
        JPUSHService.setBadge(0)
        application.cancelAllLocalNotifications()
    }
    
    func applicationDidBecomeActive(application: UIApplication) {
        // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface. 
        application.applicationIconBadgeNumber = 0
        JPUSHService.setBadge(0) 
        application.cancelAllLocalNotifications()
        
//        /*************************************************************/
//        // å¤„ç†æ”¯ä»˜æ—¶å±å¹•å·¦ä¸Šè§’çš„ç³»ç»Ÿçº§è¿”å›æŒ‰é’®
//        if Current_pay_type == CURRENT_PAY_TYPE.ALIPAY {
//            //æ”¯ä»˜å®
//            if isSuccessWithPayType {
//                //
//            }
//          //  Current_pay_type = .NONE
//        }else if Current_pay_type == CURRENT_PAY_TYPE.WEIXIN{
//            
//            // å‘å‡ºå¾®ä¿¡æ”¯ä»˜å¤±è´¥é€šçŸ¥
//            if isSuccessWithPayType {
//                // å‘å‡ºå¾®ä¿¡æ”¯ä»˜æˆåŠŸé€šçŸ¥
//                NSNotificationCenter.defaultCenter().postNotificationName("WEIXINPAYSUCCESS", object: nil)
//                
//
//            }else{
//                
//                 // å‘å‡ºå¾®ä¿¡æ”¯ä»˜å¤±è´¥é€šçŸ¥
//                 NSNotificationCenter.defaultCenter().postNotificationName("WEIXINPAYFAIL", object: nil)
//            }
//            
//           
//        }
//        
//        Current_pay_type = .NONE
//        isSuccessWithPayType = false
    }
    
    func applicationWillTerminate(application: UIApplication) {
        // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.
        // Saves changes in the application's managed object context before the application terminates.
        if NSUserDefaults.standardUserDefaults().valueForKey(UserDefaultsUserIDKey) != nil {
            DataManager.defaultManager.saveChanges()
        }
        
    }
    
    
    
    
    //MARK: - æå…‰é€šçŸ¥æ–¹æ³•
    //æ³¨å†Œæ¨é€æ¶ˆæ¯
    func application(application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: NSData) {
        print("deviceToken:\(deviceToken)")
        //        let registraID = JPUSHService.registrationID()
        JPUSHService.registerDeviceToken(deviceToken)
        print("æ³¨å†Œè®¾å¤‡æˆåŠŸ")
    }
    
    //æ¨é€æ¶ˆæ¯æˆåŠŸåè°ƒç”¨
    func application(application: UIApplication, didReceiveRemoteNotification userInfo: [NSObject : AnyObject]) {
        print("ç¨‹åºåœ¨å‰å°zhu" + "\(userInfo)")
        JPUSHService.handleRemoteNotification(userInfo)
        
    }
    
    //iOS 7.0æ–¹æ³•
    func application(application: UIApplication, didReceiveRemoteNotification userInfo: [NSObject : AnyObject], fetchCompletionHandler completionHandler: (UIBackgroundFetchResult) -> Void) {
        
        if application.applicationState == UIApplicationState.Active {
            //            AudioServicesDisposeSystemSoundID(1007);
            
            if let pushGY = pushType {
                switch pushGY {
                case PushType.Orderrob:
                    //å»ºç«‹çš„SystemSoundIDå¯¹è±¡
                    var soundID:SystemSoundID = 0
                    //è·å–å£°éŸ³åœ°å€
                    let path = NSBundle.mainBundle().pathForResource("message", ofType: "wav")
                    //åœ°å€è½¬æ¢
                    let baseURL = NSURL(fileURLWithPath: path!)
                    //èµ‹å€¼
                    AudioServicesCreateSystemSoundID(baseURL, &soundID)
                    //æ’­æ”¾å£°éŸ³
                    AudioServicesPlaySystemSound(soundID)
                case PushType.String,PushType.Ordernotify,PushType.Score:
                    //                    AudioServicesDisposeSystemSoundID(1007)
                    AudioServicesPlaySystemSound(1007)
                }
            }
            
            completionHandler(UIBackgroundFetchResult.NewData)
            
        } else if application.applicationState == UIApplicationState.Background{
            JPUSHService.handleRemoteNotification(userInfo)
            completionHandler(UIBackgroundFetchResult.NewData)
            //            print("ç¨‹åºåœ¨åå°ZHU" + "\(userInfo)")
            //            print(userInfo["aps"]!["alert"])
            pushSoundAction()
            
        } else {
            completionHandler(UIBackgroundFetchResult.NewData)
            pushSoundAction()
            
        }
    }
    
    func pushSoundAction() {
        if let pushGY = pushType {
            switch pushGY {
            case PushType.Orderrob:
                NSNotificationCenter.defaultCenter().postNotificationName(OrderPushNotification, object: nil,userInfo: nil)
                
            case PushType.String,PushType.Score:
                NSNotificationCenter.defaultCenter().postNotificationName(OrderPushNotificationString, object: nil,userInfo: nil)
            case PushType.Ordernotify:
                print("æŒ‡æ´¾è®¢å•")
            }
        } else {
            
            NSNotificationCenter.defaultCenter().postNotificationName(OrderPushNotification, object: nil,userInfo: nil)
            
        }
    }
    
    //æ³¨å†Œæ¨é€å¤±è´¥
    func application(application: UIApplication, didFailToRegisterForRemoteNotificationsWithError error: NSError) {
        print("Errorwd:\(error)")
    }
    
    //MARK: - æå…‰æ¨é€ç›‘å¬
    
    func JPushDidSetup(noti:NSNotification)
    {
        print("å»ºç«‹è¿æ¥")
    }
    
    func JPushDidClose(noti:NSNotification)  {
        print("å…³é—­è¿æ¥")
    }
    
    func JPushDidRegister(noti:NSNotification)  {
        print("æ³¨å†ŒæˆåŠŸ")
    }
    func JPushDidLogin(noti:NSNotification)  {
        //        print("ç™»å½•æˆåŠŸ")
        //        print("ğŸ·" + "registraID:\(JPUSHService.registrationID())")
        //        print(User.currentUser?.usertoken)
        //        User.BingJgNotifyId(JPUSHService.registrationID(), success: {
        //            print("ç»‘å®šæå…‰é€šçŸ¥æˆåŠŸ")
        //        }) { (error:NSError) in
        //            print(error)
        //        }
    }
    
    //MARK: - æ¥å—è‡ªå®šä¹‰æ¶ˆæ¯å’Œé€šçŸ¥æ¶ˆæ¯
    func JPushDidReceiveMessage(noti:NSNotification)  {
        
        let tmp = noti.userInfo!["content"] as! String
        print(tmp)
        if  let data = tmp.dataUsingEncoding(NSUTF8StringEncoding) {
            let dic = try? NSJSONSerialization.JSONObjectWithData(data, options: NSJSONReadingOptions.AllowFragments) as? [String: AnyObject]
            let userId = dic!!["SendUserid"]?.stringValue ?? ""
            let strNum =  MessageModel.updateSource(userId, entityName: "") ?? "0"
            
            let model = MessageModel.cachedObjectWithID(dic!!["MsgId"] as! String)
            model.sendUserid = dic!!["SendUserid"]?.stringValue ?? ""
            model.msgId = dic!!["MsgId"] as? String ?? ""
            
            print(model.sendUserid)
            model.recvUserid = dic!!["RecvUserid"]?.stringValue ?? ""
            model.sendNickName = dic!!["SendNickName"] as? String ?? ""
            model.messageType = dic!!["MessageType"] as? String ?? ""
            model.sendImageUrl = dic!!["SendImageUrl"] as? String ?? ""
            if model.messageType == "score" {
                if model.sendImageUrl != "" {
                    model.sendImageUrl =  model.sendImageUrl!
                }
            } else {
                if model.sendImageUrl != "" {
                    model.sendImageUrl = "http://wechat.hoyofuwu.com" +  model.sendImageUrl!
                }
            }
            
            if let typeGY = model.messageType {
                
                switch  typeGY {
                case "string":
                    pushType = PushType.String
                case "score":
                    pushType = PushType.Score
                case "ordernotify":
                    pushType = PushType.Ordernotify
                case "orderrob":
                    pushType = PushType.Orderrob
                    
                default:
                    break
                }
            }
            
            model.messageCon = dic!!["MessageCon"] as? String ?? ""
            model.createTime = dic!!["CreateTime"] as? String ?? ""
            model.messageNum = String(Int(strNum)! + 1)
            print(model.messageNum)
            print(model)
            
            let scoreModel = ScoreMessageModel.cachedObjectWithID(dic!!["MsgId"] as! String)
            scoreModel.msgId = dic!!["MsgId"] as? String ?? ""
            scoreModel.sendUserid = dic!!["SendUserid"]?.stringValue ?? ""
            scoreModel.recvUserid = dic!!["RecvUserid"]?.stringValue ?? ""
            scoreModel.sendNickName = dic!!["SendNickName"] as? String ?? ""
            scoreModel.sendImageUrl = dic!!["SendImageUrl"] as? String ?? ""
            if scoreModel.sendImageUrl != "" {
                scoreModel.sendImageUrl = "http://wechat.hoyofuwu.com" +  scoreModel.sendImageUrl!
            }
            scoreModel.messageCon = dic!!["MessageCon"] as? String ?? ""
            scoreModel.messageType = dic!!["MessageType"] as? String ?? ""
            scoreModel.createTime = dic!!["CreateTime"] as? String ?? ""
            scoreModel.remark = dic!!["Remark"] as? String ?? ""
            DataManager.defaultManager!.saveChanges()
            print("è¿›å…¥äº†")
            // åå°å‰å°éƒ½è¿›ï¼Œä¼šå¯¼è‡´å£°éŸ³é‡å¤
            //            AudioServicesPlaySystemSound(1007)
            NSNotificationCenter.defaultCenter().postNotificationName(messageNotification, object: nil, userInfo: ["messageNum": "1"])
            
        }
        
    }
    
    //å›è°ƒå‡½æ•°
    func application(application: UIApplication, handleActionWithIdentifier identifier: String?, forRemoteNotification userInfo: [NSObject : AnyObject], completionHandler: () -> Void) {
        print("å›è°ƒäº†")
    }
    
    
    //ç‰ˆæœ¬æ›´æ–°
    func CheckVerion() {
        let storeString = "http://itunes.apple.com/lookup?id=1116961418"
        let storeURL = NSURL(string: storeString)
        let request = NSMutableURLRequest(URL: storeURL!)
        request.HTTPMethod = "GET"
        //        let queue = NSOperationQueue()
        let dataTask = NSURLSession.sharedSession().dataTaskWithRequest(request) { (data, response, error1) in
            do {
                let appData =   try NSJSONSerialization.JSONObjectWithData(data!, options: NSJSONReadingOptions.AllowFragments) as? NSDictionary
                
                dispatch_async(dispatch_get_main_queue(), {
                    
                    guard appData!["results"]![0] != nil else {
                        return
                    }
                    
                    let versionsInAppStore = appData!["results"]![0]["version"] as? String
                    
                    let version1 = NSBundle.mainBundle().infoDictionary!["CFBundleShortVersionString"] as? String
                    
                    let describeStr = appData!["results"]![0]["releaseNotes"] as? String ?? ""
                    
                    if versionsInAppStore?.compare(version1!) == NSComparisonResult.OrderedAscending {
                        print("å·²æ˜¯æœ€æ–°")
                    } else {
                        let alertView = SCLAlertView()
                        alertView.addButton("å‰å¾€æ›´æ–° ", action: {
                            let url = "https://itunes.apple.com/cn/app/fm-lu-xing-jie-ban-lu-xing/id1116961418?mt=8";
                            UIApplication.sharedApplication().openURL(NSURL(string: url)!)
                            
                        })
                        alertView.addButton("å–æ¶ˆ", action: {})
                        
                        alertView.showInfo("å‘ç°æ–°ç‰ˆæœ¬" + versionsInAppStore!, subTitle: describeStr)
                    }
                    
                })
            }catch let error1 as NSError{
                print(error1)
            }
            
            } as NSURLSessionTask
        
        dataTask.resume()
        /*
         NSURLConnection.sendAsynchronousRequest(request, queue: queue) { (response, data, error1) in
         
         do {
         let appData =   try NSJSONSerialization.JSONObjectWithData(data!, options: NSJSONReadingOptions.AllowFragments) as? NSDictionary
         print(appData!)
         dispatch_async(dispatch_get_main_queue(), {
         let versionsInAppStore = appData!["results"]![0]["version"] as? String
         print(versionsInAppStore)
         
         let version1 = NSBundle.mainBundle().infoDictionary!["CFBundleShortVersionString"] as! String
         print(version1)
         if versionsInAppStore  == version1 {
         print("å·²æ˜¯æœ€æ–°")
         } else {
         print("æ›´æ–°")
         }
         
         })
         }catch let error1 as NSError{
         print(error1)
         }
         
         }
         
         */
    }
    
    
    /************************************/
    // å¾®ä¿¡æ”¯ä»˜å›è°ƒ
    
    
    // å¾®ä¿¡æ”¯ä»˜å›è°ƒ
    
    func onResp(resp: BaseResp!) {
        if resp.isKindOfClass(PayResp) {
            let response = resp as! PayResp
            switch  response.errCode {
            case WXSuccess.rawValue:
                
                // å‘å‡ºå¾®ä¿¡æ”¯ä»˜æˆåŠŸé€šçŸ¥
                NSNotificationCenter.defaultCenter().postNotificationName("WEIXINPAYSUCCESS", object: nil)
                
            default:
                
<<<<<<< HEAD
                // å‘å‡ºæ”¯ä»˜å¤±è´¥é€šçŸ¥
                NSNotificationCenter.defaultCenter().postNotificationName("WEIXINPAYFAIL", object: nil)
                
=======
              // å‘å‡ºå¾®ä¿¡æ”¯ä»˜å¤±è´¥é€šçŸ¥
               NSNotificationCenter.defaultCenter().postNotificationName("WEIXINPAYFAIL", object: nil)
                    
>>>>>>> master
                
            }
            
        }
    }
    
    
    
}

